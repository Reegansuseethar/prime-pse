<div class="question-bar" *ngIf="!showList">
    <strong>Add Question</strong>
</div>
<div class="row add-ques" *ngIf="!showList">
    <div class="col-sm-10">
        <form [formGroup]="questionForm" (ngSubmit)="onSubmit()">

            <div class="row">
                <div class="form-group col-sm-6 ques-name">
                    <span class="checkbox-bar">
                        <label style="margin-left: 2rem;" class="ques-rate">Free Question</label>
                        <label class="container">
                            <input type="checkbox" name="free" formControlName="freeQuestion"> <span
                                class="checkmark"></span>
                        </label>
                    </span>
                </div>

                <div class="form-group col-sm-6 ques-name">
                    <span class="checkbox-bar">
                        <label class="ques-rate">Premium Question</label>
                        <label class="container">
                            <input type="checkbox" name="premium" formControlName="premiumQuestion"> <span
                                class="checkmark"></span>
                        </label>
                    </span>
                </div>

                <div class="form-group col-sm-12 ques-name">
                    <i class="fa fa-chevron-down select-icon" aria-hidden="true"></i>
                    <select id="type" name="type" class="form-control question-group" formControlName="questionGroup"
                        [ngClass]="{ 'is-invalid': submitted && f.questionGroup.errors }"
                        (change)="changeGroup($event.target.value)">
                        <option value="" selected disabled>--- Select Question Group ---</option>
                        <option [value]="data._id" *ngFor="let data of grouplist">{{data.questionGroup}}</option>
                    </select>
                    <div *ngIf="submitted && f.questionGroup.errors" class="invalid-feedback">
                        <div *ngIf="f.questionGroup.errors.required">Question group is required</div>
                    </div>
                </div>

                <div class="form-group col-sm-12 ques-name">
                    <i class="fa fa-chevron-down select-icon" aria-hidden="true"></i>
                    <select id="type" name="type" class="form-control question-group" formControlName="questionSubgroup"
                        name=group [ngClass]="{ 'is-invalid': submitted && f.questionSubgroup.errors }">
                        <option value="" selected disabled>--- Select Subquestion Group ---</option>
                        <option [value]="data._id" *ngFor="let data of subGrouplist">{{data.questionSubgroup}}</option>
                    </select>
                    <div *ngIf="submitted && f.questionSubgroup.errors" class="invalid-feedback">
                        <div *ngIf="f.questionSubgroup.errors.required">Subgroup is required</div>
                    </div>
                </div>

                <div class="form-group col-sm-12 ques-name">
                    <i class="fa fa-question-circle-o input-icon" aria-hidden="true"></i>
                    <input type="text" class="form-control question-name" name="ques" formControlName="questionName"
                        placeholder="Click to start typing the question..."
                        [ngClass]="{ 'is-invalid': submitted && f.questionName.errors }">
                    <div *ngIf="submitted && f.questionName.errors" class="invalid-feedback">
                        <div *ngIf="f.questionName.errors.required">Question is required</div>
                    </div>
                </div>

                <div class="row">
                    <div class="form-group col-sm-5" *ngIf="!optionImage1">
                        <i class="fa fa-pencil-square option-icon" style="color: purple;" aria-hidden="true"></i>
                        <input type="text" class="form-control option-name" name="opt1" formControlName="option1"
                            placeholder="Add Option 1" [ngClass]="{ 'is-invalid': submitted && f.option1.errors }">
                        <div *ngIf="submitted && f.option1.errors" class="invalid-feedback">
                            <div *ngIf="f.option1.errors.required">Option is required</div>
                        </div>
                    </div>

                    <div class="col-sm-1" *ngIf="optionImage1">
                        <img [src]="questionForm.value.option1" style="height: 40px;width: 43px;">
                    </div>

                    <div class="form-group col-sm-4" *ngIf="optionImage1">
                        <i class="fa fa-upload upload-icon" style="color: purple;" aria-hidden="true"></i>
                        <input type="file" class="form-control option-name" accept="image/*"
                            (change)="uploadImage($event,'option1')">
                    </div>

                    <div class="form-group col-sm-1">
                        <span class="checkbox-bar">
                            <label class="container">
                                <input type="checkbox" [checked]="optionImage1" name="premium"
                                    (change)="enableOption1($event.target.checked)">
                                <span class="checkmark"></span>
                            </label>
                        </span>
                    </div>

                    <div class="form-group col-sm-5" *ngIf="!optionImage2">
                        <i class="fa fa-pencil-square option-icon" style="color:firebrick;" aria-hidden="true"></i>
                        <input type="text" class="form-control option-name" name="opt2" formControlName="option2"
                            placeholder="Add Option 2" [ngClass]="{ 'is-invalid': submitted && f.option2.errors }">
                        <div *ngIf="submitted && f.option2.errors" class="invalid-feedback">
                            <div *ngIf="f.option2.errors.required">Option is required</div>
                        </div>
                    </div>

                    <div class="col-sm-1" *ngIf="optionImage2">
                        <img [src]="questionForm.value.option2" style="height: 40px;width: 43px;">
                    </div>

                    <div class="form-group col-sm-4" *ngIf="optionImage2">
                        <i class="fa fa-upload upload-icon" style="color:firebrick;" aria-hidden="true"></i>
                        <input type="file" class="form-control option-name" name="opt2" accept="image/*"
                            (change)="uploadImage($event,'option2')">
                    </div>

                    <div class="form-group col-sm-1">
                        <span class="checkbox-bar">
                            <label class="container">
                                <input type="checkbox" [checked]="optionImage2" name="premium2"
                                    (change)="enableOption2($event.target.checked)">
                                <span class="checkmark"></span>
                            </label>
                        </span>
                    </div>

                    <div class="form-group col-sm-5" *ngIf="!optionImage3">
                        <i class="fa fa-pencil-square option-icon" style="color: rgb(8, 65, 32);"
                            aria-hidden="true"></i>
                        <input type="text" class="form-control option-name" name="opt3" formControlName="option3"
                            placeholder="Add Option 3" [ngClass]="{ 'is-invalid': submitted && f.option3.errors }">
                        <div *ngIf="submitted && f.option3.errors" class="invalid-feedback">
                            <div *ngIf="f.option3.errors.required">Option is required</div>
                        </div>
                    </div>

                    <div class="col-sm-1" *ngIf="optionImage3">
                        <img [src]="questionForm.value.option3" style="height: 40px;width: 43px;">
                    </div>

                    <div class="form-group col-sm-4" *ngIf="optionImage3">
                        <i class="fa fa-upload upload-icon" style="color: rgb(8, 65, 32);" aria-hidden="true"></i>
                        <input type="file" class="form-control option-name" name="opt3" accept="image/*"
                            (change)="uploadImage($event,'option3')">
                    </div>

                    <div class="form-group col-sm-1">
                        <span class="checkbox-bar">
                            <label class="container">
                                <input type="checkbox" [checked]="optionImage3" name="premium3"
                                    (change)="enableOption3($event.target.checked)">
                                <span class="checkmark"></span>
                            </label>
                        </span>
                    </div>

                    <div class="form-group col-sm-5" *ngIf="!optionImage4">
                        <i class="fa fa-pencil-square option-icon" style="color: rgb(34, 28, 95);"
                            aria-hidden="true"></i>
                        <input type="text" class="form-control option-name" name="opt4" formControlName="option4"
                            placeholder="Add Option 4" [ngClass]="{ 'is-invalid': submitted && f.option4.errors }">
                        <div *ngIf="submitted && f.option4.errors" class="invalid-feedback">
                            <div *ngIf="f.option4.errors.required">Option is required</div>
                        </div>
                    </div>

                    <div class="col-sm-1" *ngIf="optionImage4">
                        <img [src]="questionForm.value.option4" style="height: 40px;width: 43px;">
                    </div>

                    <div class="form-group col-sm-4" *ngIf="optionImage4">
                        <i class="fa fa-upload upload-icon" style="color: rgb(34, 28, 95);" aria-hidden="true"></i>
                        <input type="file" class="form-control option-name" accept="image/*"
                            (change)="uploadImage($event,'option4')">
                    </div>

                    <div class="form-group col-sm-1">
                        <span class="checkbox-bar">
                            <label class="container">
                                <input type="checkbox" [checked]="optionImage4" name="premium4"
                                    (change)="enableOption4($event.target.checked)">
                                <span class="checkmark"></span>
                            </label>
                        </span>
                    </div>
                </div>

                <div class="form-group col-sm-6 correct-ans"> Correct Answer
                </div>
                <div class="form-group col-sm-6">
                    <i class="fa fa-check-square option-icon" style="color: green;" aria-hidden="true"></i>
                    <input type="text" class="form-control option-name" name="ans" formControlName="answer"
                        placeholder="Correct Option" [ngClass]="{ 'is-invalid': submitted && f.answer.errors }">
                    <div *ngIf="submitted && f.answer.errors" class="invalid-feedback">
                        <div *ngIf="f.answer.errors.required">Answer is required</div>
                        <div *ngIf="f.answer.errors.pattern">Option numbers only Available</div>
                    </div>
                </div>
            </div>

            <div class="button-bar">
                <button type="button" style="margin-right: 11px" class="btn btn-md btn-primary"
                    (click)="cancel()">Cancel</button>
                <button type="submit" class="btn btn-md btn-primary">Submit</button>
            </div>
        </form>
    </div>
</div>

<div *ngIf="showList">

    <div class="row ques-table">
        <div class="col-sm-6">
            <select id="type" name="type" class="form-control" style="width: 50%;"
                (change)="getGroupQues($event.target.value)">
                <option value="all" selected>--- Get All Questions ---</option>
                <option [value]="data._id" *ngFor="let data of grouplist">{{data.questionGroup}}</option>
            </select>
        </div>
        <div class="col-sm-6 add-btn">
            <button type="button" class="btn btn-md btn-primary" (click)="addQuestion()">ADD QUESTION</button>
        </div>
    </div>
    <div class="">
        <table class="table table-responsive-sm table-hover table-outline mb-0">
            <thead class="thead-light">
                <tr>
                    <th class="text-left">Question</th>
                    <th class="text-left white-space">Question group</th>
                    <th class="text-left">Sub Group Name</th>
                    <!-- <th class="text-left">Options</th> -->
                    <th class="text-left">Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let data of questionList; let i=index">
                    <td class="text-left">{{data.questionName}}</td>
                    <td class="text-left">{{data.groupName}}</td>
                    <td class="text-left">{{data.subgroupName}}</td>
                    <td class="text-left white-space"><i class="fa fa-pencil-square-o fa-lg edit-icon"
                            (click)="editQuestion(data._id)"></i>&nbsp;&nbsp;&nbsp;<i
                            class="fa fa-trash fa-lg remove-icon" (click)="openModel(data._id)"></i></td>
                </tr>
            </tbody>
        </table>
        <!-- <span class="empty-data" *ngIf='noData'>No Data Available</span>
        <pagination-controls (pageChange)="p = $event"></pagination-controls> -->
    </div>
</div>

<div bsModal #deleteModal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="deleteModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-body dialog-modal">
                Are you sure you want to remove?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-md btn-primary" (click)="deleteModal.hide()">Close</button>
                <button type="button" class="btn btn-md btn-primary" (click)="removeQues()">Confirm </button>
            </div>
        </div>
    </div>
</div>